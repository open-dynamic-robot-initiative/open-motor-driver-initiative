Version 4
SHEET 1 6632 2884
WIRE 1872 -688 1280 -688
WIRE 4080 -688 2320 -688
WIRE 4704 -688 4208 -688
WIRE 1488 -576 1360 -576
WIRE 1664 -576 1568 -576
WIRE 1744 -576 1664 -576
WIRE -2160 -560 -2272 -560
WIRE -1760 -560 -1920 -560
WIRE 304 -544 304 -576
WIRE 1360 -528 1360 -576
WIRE 1040 -512 1040 -592
WIRE 1664 -512 1664 -576
WIRE -1920 -496 -1920 -560
WIRE -2272 -480 -2272 -560
WIRE 528 -480 432 -480
WIRE 672 -480 592 -480
WIRE 784 -480 752 -480
WIRE 880 -480 880 -528
WIRE 2656 -464 2464 -464
WIRE 3008 -464 2800 -464
WIRE 3216 -464 3152 -464
WIRE 3488 -464 3376 -464
WIRE 304 -432 304 -464
WIRE 2464 -432 2464 -464
WIRE 432 -400 432 -480
WIRE 624 -400 432 -400
WIRE 784 -400 784 -480
WIRE 784 -400 704 -400
WIRE 832 -400 784 -400
WIRE -1920 -384 -1920 -416
WIRE 1360 -384 1360 -448
WIRE 1664 -384 1664 -448
WIRE -384 -368 -608 -368
WIRE -128 -368 -384 -368
WIRE 432 -368 432 -400
WIRE 3760 -368 3760 -416
WIRE -2272 -352 -2272 -400
WIRE -2272 -352 -2336 -352
WIRE -1280 -352 -1280 -384
WIRE -128 -352 -176 -352
WIRE 384 -352 -64 -352
WIRE -2336 -336 -2336 -352
WIRE -176 -336 -176 -352
WIRE -128 -336 -176 -336
WIRE -2272 -320 -2272 -352
WIRE -176 -320 -176 -336
WIRE -128 -320 -176 -320
WIRE 1488 -320 1360 -320
WIRE 1664 -320 1568 -320
WIRE 1744 -320 1664 -320
WIRE -960 -304 -960 -384
WIRE -384 -304 -384 -368
WIRE -352 -304 -384 -304
WIRE -240 -304 -272 -304
WIRE -128 -304 -240 -304
WIRE 384 -304 352 -304
WIRE -1008 -288 -1104 -288
WIRE -176 -272 -176 -320
WIRE -112 -272 -112 -304
WIRE -112 -272 -176 -272
WIRE 432 -272 432 -288
WIRE 880 -272 880 -384
WIRE 880 -272 432 -272
WIRE 1104 -272 880 -272
WIRE 1360 -272 1360 -320
WIRE 2624 -272 2576 -272
WIRE 2736 -272 2736 -400
WIRE 2736 -272 2704 -272
WIRE -112 -256 -112 -272
WIRE 1664 -256 1664 -320
WIRE 3760 -256 3760 -288
WIRE -1280 -240 -1280 -272
WIRE -1104 -240 -1104 -288
WIRE -1008 -240 -1056 -240
WIRE 2736 -240 2736 -272
WIRE -384 -224 -384 -304
WIRE -336 -224 -384 -224
WIRE -240 -224 -240 -304
WIRE -240 -224 -272 -224
WIRE 2576 -208 2576 -272
WIRE -240 -192 -240 -224
WIRE -2272 -176 -2272 -240
WIRE -2160 -176 -2272 -176
WIRE 528 -160 432 -160
WIRE 672 -160 592 -160
WIRE 784 -160 752 -160
WIRE 880 -160 880 -272
WIRE -1920 -144 -1920 -208
WIRE -1808 -144 -1920 -144
WIRE -1488 -144 -1488 -208
WIRE -1488 -144 -1664 -144
WIRE -1232 -144 -1488 -144
WIRE -1056 -144 -1056 -240
WIRE -1056 -144 -1088 -144
WIRE 1360 -128 1360 -192
WIRE 1664 -128 1664 -192
WIRE -240 -96 -240 -128
WIRE 432 -80 432 -160
WIRE 624 -80 432 -80
WIRE 784 -80 784 -160
WIRE 784 -80 704 -80
WIRE 832 -80 784 -80
WIRE -960 -48 -960 -224
WIRE -608 -48 -608 -368
WIRE -608 -48 -960 -48
WIRE -496 -48 -608 -48
WIRE -384 -48 -432 -48
WIRE -128 -48 -384 -48
WIRE 432 -48 432 -80
WIRE 1440 -48 1360 -48
WIRE 1552 -48 1520 -48
WIRE 1664 -48 1552 -48
WIRE 1744 -48 1664 -48
WIRE -128 -32 -176 -32
WIRE 384 -32 -64 -32
WIRE -1152 -16 -1152 -80
WIRE -1152 -16 -1280 -16
WIRE -176 -16 -176 -32
WIRE -128 -16 -176 -16
WIRE -960 0 -960 -48
WIRE -496 0 -496 -32
WIRE -176 0 -176 -16
WIRE -128 0 -176 0
WIRE 1360 0 1360 -48
WIRE -1056 16 -1056 -144
WIRE -1008 16 -1056 16
WIRE -384 16 -384 -48
WIRE -352 16 -384 16
WIRE -240 16 -272 16
WIRE -128 16 -240 16
WIRE 352 16 352 -304
WIRE 384 16 352 16
WIRE 880 16 880 -64
WIRE 976 16 880 16
WIRE 1552 16 1552 -48
WIRE 1664 16 1664 -48
WIRE 2320 16 2320 -688
WIRE 4080 16 4080 -688
WIRE 4080 16 2320 16
WIRE -176 48 -176 0
WIRE -112 48 -112 16
WIRE -112 48 -176 48
WIRE -1008 64 -1056 64
WIRE -112 64 -112 48
WIRE 352 64 352 16
WIRE 432 64 432 32
WIRE 432 64 352 64
WIRE 880 64 880 16
WIRE -384 96 -384 16
WIRE -336 96 -384 96
WIRE -240 96 -240 16
WIRE -240 96 -272 96
WIRE 1360 112 1360 80
WIRE 1552 112 1552 96
WIRE 1552 112 1360 112
WIRE 1664 112 1664 80
WIRE 1664 112 1552 112
WIRE -1056 128 -1056 64
WIRE -960 128 -960 80
WIRE -240 128 -240 96
WIRE 1360 144 1360 112
WIRE 1664 144 1664 112
WIRE -240 224 -240 192
WIRE 880 224 880 144
WIRE 4080 240 3168 240
WIRE 1280 288 1280 -688
WIRE 1872 288 1872 -688
WIRE 1872 288 1280 288
WIRE 3712 384 3520 384
WIRE 4208 384 4208 -688
WIRE 4704 384 4704 -688
WIRE 4704 384 4208 384
WIRE 528 416 432 416
WIRE 672 416 592 416
WIRE 784 416 752 416
WIRE 880 416 880 368
WIRE -2736 464 -2736 368
WIRE -2672 464 -2736 464
WIRE -2416 464 -2528 464
WIRE -2080 464 -2272 464
WIRE -1728 464 -1728 -80
WIRE -1728 464 -2080 464
WIRE 1104 480 1104 -272
WIRE 1312 480 1104 480
WIRE 1344 480 1312 480
WIRE 1472 480 1424 480
WIRE 2176 480 2016 480
WIRE 432 496 432 416
WIRE 624 496 432 496
WIRE 784 496 784 416
WIRE 784 496 704 496
WIRE 832 496 784 496
WIRE -2304 528 -2304 496
WIRE -2304 528 -2384 528
WIRE -384 528 -608 528
WIRE -128 528 -384 528
WIRE 432 528 432 496
WIRE -128 544 -176 544
WIRE 384 544 -64 544
WIRE 3440 544 3440 384
WIRE 3712 544 3712 384
WIRE 3712 544 3520 544
WIRE 3856 544 3712 544
WIRE -2304 560 -2304 528
WIRE -176 560 -176 544
WIRE -128 560 -176 560
WIRE -2592 576 -2592 528
WIRE -2528 576 -2592 576
WIRE -176 576 -176 560
WIRE -128 576 -176 576
WIRE -960 592 -960 512
WIRE -384 592 -384 528
WIRE -352 592 -384 592
WIRE -240 592 -272 592
WIRE -128 592 -240 592
WIRE 352 592 352 64
WIRE 384 592 352 592
WIRE -1008 608 -1104 608
WIRE -176 624 -176 576
WIRE -112 624 -112 592
WIRE -112 624 -176 624
WIRE 432 624 432 608
WIRE 880 624 880 512
WIRE 880 624 432 624
WIRE 1312 624 880 624
WIRE 1344 624 1312 624
WIRE 1472 624 1424 624
WIRE 1552 624 1552 480
WIRE 2176 624 2176 480
WIRE 2176 624 2016 624
WIRE 3856 624 3856 544
WIRE -112 640 -112 624
WIRE -1104 656 -1104 608
WIRE -1008 656 -1056 656
WIRE -384 672 -384 592
WIRE -336 672 -384 672
WIRE -240 672 -240 592
WIRE -240 672 -272 672
WIRE 5040 672 4976 672
WIRE 5216 672 5136 672
WIRE -2592 688 -2592 576
WIRE -240 704 -240 672
WIRE 3440 704 3440 544
WIRE 3712 704 3712 544
WIRE 3712 704 3520 704
WIRE 528 736 432 736
WIRE 672 736 592 736
WIRE 784 736 752 736
WIRE 880 736 880 624
WIRE -1920 752 -1920 688
WIRE -1808 752 -1920 752
WIRE -1488 752 -1488 688
WIRE -1488 752 -1664 752
WIRE -1232 752 -1488 752
WIRE -1056 752 -1056 656
WIRE -1056 752 -1088 752
WIRE 1312 768 1104 768
WIRE 1344 768 1312 768
WIRE 1472 768 1424 768
WIRE 1552 768 1552 624
WIRE 2176 768 2176 624
WIRE 2176 768 2016 768
WIRE -2592 800 -2592 768
WIRE -240 800 -240 768
WIRE 3440 800 3440 704
WIRE 3856 800 3856 704
WIRE 3856 800 3440 800
WIRE 432 816 432 736
WIRE 624 816 432 816
WIRE 784 816 784 736
WIRE 784 816 704 816
WIRE 832 816 784 816
WIRE 3440 816 3440 800
WIRE 5040 816 5040 672
WIRE 5088 816 5040 816
WIRE -960 848 -960 672
WIRE -608 848 -608 528
WIRE -608 848 -960 848
WIRE -496 848 -608 848
WIRE -384 848 -432 848
WIRE -128 848 -384 848
WIRE 432 848 432 816
WIRE -128 864 -176 864
WIRE 384 864 -64 864
WIRE 5088 864 5088 816
WIRE -2736 880 -2736 464
WIRE -1280 880 -1280 -16
WIRE -1152 880 -1152 816
WIRE -1152 880 -1280 880
WIRE -176 880 -176 864
WIRE -128 880 -176 880
WIRE 5056 880 5024 880
WIRE -960 896 -960 848
WIRE -496 896 -496 864
WIRE -176 896 -176 880
WIRE -128 896 -176 896
WIRE 5360 896 5120 896
WIRE -1056 912 -1056 752
WIRE -1008 912 -1056 912
WIRE -384 912 -384 848
WIRE -352 912 -384 912
WIRE -240 912 -272 912
WIRE -128 912 -240 912
WIRE 352 912 352 592
WIRE 384 912 352 912
WIRE 5056 912 4800 912
WIRE 880 928 880 832
WIRE 976 928 880 928
WIRE -176 944 -176 896
WIRE -112 944 -112 912
WIRE -112 944 -176 944
WIRE 3456 944 3440 944
WIRE 3584 944 3536 944
WIRE -1008 960 -1056 960
WIRE -112 960 -112 944
WIRE 352 960 352 912
WIRE 432 960 432 928
WIRE 432 960 352 960
WIRE 5024 960 5024 880
WIRE 5088 960 5088 928
WIRE 5216 960 5216 672
WIRE 5216 960 5088 960
WIRE 5360 976 5360 896
WIRE 5392 976 5360 976
WIRE 5664 976 5456 976
WIRE -2736 992 -2736 960
WIRE -384 992 -384 912
WIRE -336 992 -384 992
WIRE -240 992 -240 912
WIRE -240 992 -272 992
WIRE 880 992 880 928
WIRE 5392 1008 5360 1008
WIRE -1056 1024 -1056 960
WIRE -960 1024 -960 976
WIRE -240 1024 -240 992
WIRE 5040 1024 5040 816
WIRE 5088 1024 5040 1024
WIRE 5088 1056 5088 1024
WIRE 5056 1072 5024 1072
WIRE 5360 1088 5360 1008
WIRE 5360 1088 5120 1088
WIRE 3440 1104 3440 944
WIRE 3456 1104 3440 1104
WIRE 3584 1104 3536 1104
WIRE 4720 1104 4720 912
WIRE 5056 1104 4800 1104
WIRE 880 1120 880 1072
WIRE 1952 1136 1888 1136
WIRE -240 1152 -240 1088
WIRE 1888 1152 1888 1136
WIRE 5088 1152 5088 1120
WIRE 5216 1152 5216 960
WIRE 5216 1152 5088 1152
WIRE 1616 1168 1392 1168
WIRE 1840 1168 1760 1168
WIRE 1952 1168 1952 1136
WIRE 1984 1168 1952 1168
WIRE 2160 1168 2128 1168
WIRE 2768 1168 2160 1168
WIRE 4720 1184 4720 1104
WIRE -2080 1200 -2080 464
WIRE -1728 1200 -1728 816
WIRE -1728 1200 -2080 1200
WIRE 1840 1216 1824 1216
WIRE 5024 1216 5024 1072
WIRE 1392 1232 1392 1168
WIRE 1824 1248 1824 1216
WIRE 1888 1248 1888 1232
WIRE 1888 1248 1824 1248
WIRE 3440 1264 3440 1104
WIRE 3456 1264 3440 1264
WIRE 3584 1264 3536 1264
WIRE 1888 1280 1888 1248
WIRE 2064 1280 2064 1232
WIRE 528 1344 432 1344
WIRE 672 1344 592 1344
WIRE 784 1344 752 1344
WIRE 880 1344 880 1296
WIRE 1696 1344 1696 1232
WIRE 1760 1344 1696 1344
WIRE 2160 1344 2160 1168
WIRE 2208 1344 2160 1344
WIRE 2400 1344 2352 1344
WIRE 2448 1344 2400 1344
WIRE 2768 1344 2592 1344
WIRE 3440 1360 3440 1264
WIRE 2320 1408 2320 1376
WIRE 2320 1408 2240 1408
WIRE 432 1424 432 1344
WIRE 624 1424 432 1424
WIRE 784 1424 784 1344
WIRE 784 1424 704 1424
WIRE 832 1424 784 1424
WIRE 2240 1440 2240 1408
WIRE 2528 1440 2528 1408
WIRE -2496 1456 -2496 1344
WIRE -384 1456 -608 1456
WIRE -128 1456 -384 1456
WIRE 432 1456 432 1424
WIRE -128 1472 -176 1472
WIRE 384 1472 -64 1472
WIRE -176 1488 -176 1472
WIRE -128 1488 -176 1488
WIRE -176 1504 -176 1488
WIRE -128 1504 -176 1504
WIRE 3600 1504 3520 1504
WIRE 3616 1504 3600 1504
WIRE -960 1520 -960 1440
WIRE -384 1520 -384 1456
WIRE -352 1520 -384 1520
WIRE -240 1520 -272 1520
WIRE -128 1520 -240 1520
WIRE 352 1520 352 960
WIRE 384 1520 352 1520
WIRE 4768 1520 4752 1520
WIRE 4928 1520 4848 1520
WIRE 5200 1520 4976 1520
WIRE -1008 1536 -1104 1536
WIRE -176 1552 -176 1504
WIRE -112 1552 -112 1520
WIRE -112 1552 -176 1552
WIRE 432 1552 432 1536
WIRE 880 1552 880 1440
WIRE 880 1552 432 1552
WIRE 1104 1552 1104 768
WIRE 1104 1552 880 1552
WIRE -2496 1568 -2496 1536
WIRE -112 1568 -112 1552
WIRE -1104 1584 -1104 1536
WIRE -1008 1584 -1056 1584
WIRE -384 1600 -384 1520
WIRE -336 1600 -384 1600
WIRE -240 1600 -240 1520
WIRE -240 1600 -272 1600
WIRE 1696 1616 1696 1344
WIRE -240 1632 -240 1600
WIRE 2400 1632 2400 1344
WIRE 2784 1632 2400 1632
WIRE 528 1664 432 1664
WIRE 672 1664 592 1664
WIRE 784 1664 752 1664
WIRE 880 1664 880 1552
WIRE -1920 1680 -1920 1632
WIRE -1808 1680 -1920 1680
WIRE -1488 1680 -1488 1616
WIRE -1488 1680 -1664 1680
WIRE -1232 1680 -1488 1680
WIRE -1056 1680 -1056 1584
WIRE -1056 1680 -1088 1680
WIRE 3440 1680 3440 1504
WIRE 3600 1680 3520 1680
WIRE -240 1728 -240 1696
WIRE 432 1744 432 1664
WIRE 624 1744 432 1744
WIRE 784 1744 784 1664
WIRE 784 1744 704 1744
WIRE 832 1744 784 1744
WIRE 1696 1744 1696 1696
WIRE -960 1776 -960 1600
WIRE -608 1776 -608 1456
WIRE -608 1776 -960 1776
WIRE -496 1776 -608 1776
WIRE -384 1776 -432 1776
WIRE -128 1776 -384 1776
WIRE 432 1776 432 1744
WIRE -128 1792 -176 1792
WIRE 384 1792 -64 1792
WIRE 2160 1792 2160 1344
WIRE 2208 1792 2160 1792
WIRE 2784 1792 2352 1792
WIRE -1280 1808 -1280 880
WIRE -1152 1808 -1152 1744
WIRE -1152 1808 -1280 1808
WIRE -176 1808 -176 1792
WIRE -128 1808 -176 1808
WIRE -960 1824 -960 1776
WIRE -496 1824 -496 1792
WIRE -176 1824 -176 1808
WIRE -128 1824 -176 1824
WIRE 3440 1824 3440 1680
WIRE 3600 1824 3520 1824
WIRE -1056 1840 -1056 1680
WIRE -1008 1840 -1056 1840
WIRE -384 1840 -384 1776
WIRE -352 1840 -384 1840
WIRE -240 1840 -272 1840
WIRE -128 1840 -240 1840
WIRE 352 1840 352 1520
WIRE 384 1840 352 1840
WIRE 2320 1856 2320 1824
WIRE 2320 1856 2240 1856
WIRE -176 1872 -176 1824
WIRE -112 1872 -112 1840
WIRE -112 1872 -176 1872
WIRE -1008 1888 -1056 1888
WIRE -112 1888 -112 1872
WIRE 352 1888 352 1840
WIRE 432 1888 432 1856
WIRE 432 1888 352 1888
WIRE 2240 1888 2240 1856
WIRE -384 1920 -384 1840
WIRE -336 1920 -384 1920
WIRE -240 1920 -240 1840
WIRE -240 1920 -272 1920
WIRE -2496 1936 -2496 1824
WIRE -1056 1952 -1056 1888
WIRE -960 1952 -960 1904
WIRE -240 1952 -240 1920
WIRE 3440 1968 3440 1824
WIRE 3600 1968 3520 1968
WIRE -1280 2016 -1280 1808
WIRE -2496 2048 -2496 2016
WIRE -240 2048 -240 2016
WIRE 352 2048 352 1888
WIRE 880 2048 880 1760
WIRE 3440 2080 3440 1968
WIRE -1280 2128 -1280 2096
WIRE -2080 2144 -2080 1200
WIRE -1728 2144 -1728 1744
WIRE -1728 2144 -2080 2144
WIRE 3168 2176 3168 240
WIRE 4080 2176 4080 240
WIRE 4080 2176 3168 2176
FLAG -1280 2128 0
FLAG -1280 -240 0
FLAG -1280 -384 Vdd
FLAG -112 -256 0
FLAG -240 -96 0
FLAG -112 64 0
FLAG -240 224 0
FLAG 304 -576 Vbus
FLAG 880 -528 Vbus_2
FLAG 880 368 Vbus_2
FLAG 1360 -384 0
FLAG 1664 -384 0
FLAG 1744 -576 Bus_Power
FLAG -112 640 0
FLAG -240 800 0
FLAG -112 960 0
FLAG -240 1152 0
FLAG -112 1568 0
FLAG -240 1728 0
FLAG -112 1888 0
FLAG -240 2048 0
FLAG 880 1296 Vbus_2
FLAG 352 2048 0
FLAG -1104 -240 0
FLAG -496 0 0
FLAG -960 -384 Vdd
FLAG -960 128 0
FLAG -496 896 0
FLAG -496 1824 0
FLAG -1056 128 0
FLAG 976 928 shunt_B
FLAG 880 2048 0
FLAG -1920 -208 Va
FLAG -1920 688 Vb
FLAG -1920 1632 Vc
FLAG -2496 2048 0
FLAG -2496 1824 Vmax_ab
FLAG -2736 992 0
FLAG -2496 1568 0
FLAG -2496 1344 Vmim_ab
FLAG -2592 800 0
FLAG -2736 368 Vmax
FLAG -2528 576 Vmin
FLAG -2304 560 0
FLAG -1488 -208 Vmod_a
FLAG -1488 688 Vmod_b
FLAG -1488 1616 Vmod_c
FLAG 304 -432 0
FLAG -1104 656 0
FLAG -960 512 Vdd
FLAG -960 1024 0
FLAG -1056 1024 0
FLAG -1104 1584 0
FLAG -960 1440 Vdd
FLAG -960 1952 0
FLAG -1056 1952 0
FLAG -1920 -384 0
FLAG -1760 -560 Va_effective
FLAG -2336 -336 0
FLAG -2160 -560 Limit_pos
FLAG -2160 -176 Limit_neg
FLAG 880 1120 0
FLAG 976 16 shunt_A
FLAG 880 224 0
FLAG 1312 624 B
FLAG 1312 480 A
FLAG 1312 768 C
FLAG 3440 816 0
FLAG 3440 2080 0
FLAG 3600 1680 EMFA
FLAG 3600 1824 EMFB
FLAG 3600 1968 EMFC
FLAG 3760 -256 0
FLAG 3760 -416 amplitude
FLAG 3440 1360 0
FLAG 3584 944 Va
FLAG 3584 1104 Vb
FLAG 3584 1264 Vc
FLAG 1360 144 0
FLAG 1664 144 0
FLAG 1744 -48 VA_filt
FLAG 2464 -352 0
FLAG 2576 -128 0
FLAG 3040 -400 0
FLAG 3120 -432 0
FLAG 3296 -384 0
FLAG 3296 -624 0
FLAG 3488 -464 Duty_cycle_ex
FLAG 2736 -176 0
FLAG 2768 1168 Wmech
FLAG 2784 1632 Wd
FLAG 2528 1440 0
FLAG 2768 1344 Theta_elec
FLAG 1760 1344 Load_Torque
FLAG 2064 1280 0
FLAG 1888 1280 0
FLAG 1696 1744 0
FLAG 2240 1888 0
FLAG 2784 1792 Wmech_RPM
FLAG 2240 1440 0
FLAG 1392 1312 0
FLAG 1360 -128 0
FLAG 1664 -128 0
FLAG 1744 -320 Bus_Power_phase
FLAG 3600 1504 EMF_TOT
FLAG 1040 -512 Vbus_2
FLAG 1040 -592 Vbus
FLAG 1040 -736 0
FLAG 2176 768 0
FLAG 4720 1184 0
FLAG 4976 752 0
FLAG 5136 752 0
FLAG 5024 960 0
FLAG 5024 1296 0
FLAG 4752 1520 0
FLAG 5200 1520 theta_elec_dephased
SYMBOL voltage -1280 2000 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 18 99 Left 2
SYMATTR Value PULSE(-0.5 0.5 0 {p/2} {p/2} 0 {p} 1E6)
SYMATTR InstName V1
SYMBOL voltage -1280 -368 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -39 93 Left 2
SYMATTR Value 5
SYMATTR InstName V3
SYMBOL Digital\\and -96 -400 R0
SYMATTR InstName A1
SYMATTR SpiceLine Vhigh=5
SYMBOL res -256 -320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 3k
SYMBOL cap -256 -192 R0
SYMATTR InstName C1
SYMATTR Value 200pF
SYMBOL schottky -272 -240 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL Digital\\and -96 -80 R0
SYMATTR InstName A2
SYMATTR SpiceLine Vhigh=5
SYMBOL res -256 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 3k
SYMBOL cap -256 128 R0
SYMATTR InstName C2
SYMATTR Value 200pF
SYMBOL schottky -272 80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage 304 -560 R0
WINDOW 0 -42 6 Left 2
WINDOW 3 -44 93 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value 63
SYMBOL e 432 -64 R0
SYMATTR InstName E1
SYMATTR Value 1.2
SYMBOL res 720 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 150
SYMBOL res 720 -416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 150
SYMBOL e 432 -384 R0
SYMATTR InstName E2
SYMATTR Value 1.2
SYMBOL schottky 592 -496 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 592 -176 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D4
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 768 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 20
SYMBOL res 768 -176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 20
SYMBOL res 1328 496 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName RA
SYMATTR Value {R_Phase}
SYMBOL ind 1456 496 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName LA
SYMATTR Value {L_Phase}
SYMBOL e 432 832 R0
SYMATTR InstName E3
SYMATTR Value 1.2
SYMBOL res 720 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 150
SYMBOL res 720 480 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 150
SYMBOL e 432 512 R0
SYMATTR InstName E4
SYMATTR Value 1.2
SYMBOL schottky 592 400 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D5
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 592 720 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D6
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 768 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 20
SYMBOL res 768 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 20
SYMBOL bv 1360 -544 R0
SYMATTR InstName B1
SYMATTR Value V=-v(Vbus)*i(V6)
SYMBOL res 1584 -592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL cap 1648 -512 R0
SYMATTR InstName C3
SYMATTR Value 0.1µF
SYMBOL Digital\\and -96 496 R0
SYMATTR InstName A3
SYMATTR SpiceLine Vhigh=5
SYMBOL res -256 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 3k
SYMBOL cap -256 704 R0
SYMATTR InstName C4
SYMATTR Value 200pF
SYMBOL schottky -272 656 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D7
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL Digital\\and -96 816 R0
SYMATTR InstName A4
SYMATTR SpiceLine Vhigh=5
SYMBOL res -256 896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 3k
SYMBOL cap -256 1024 R0
SYMATTR InstName C5
SYMATTR Value 200pF
SYMBOL schottky -272 976 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D8
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL Digital\\and -96 1424 R0
SYMATTR InstName A5
SYMATTR SpiceLine Vhigh=5
SYMBOL res -256 1504 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 3k
SYMBOL cap -256 1632 R0
SYMATTR InstName C6
SYMATTR Value 200pF
SYMBOL schottky -272 1584 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D9
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL Digital\\and -96 1744 R0
SYMATTR InstName A6
SYMATTR SpiceLine Vhigh=5
SYMBOL res -256 1824 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 3k
SYMBOL cap -256 1952 R0
SYMATTR InstName C7
SYMATTR Value 200pF
SYMBOL schottky -272 1904 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D10
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL e 432 1760 R0
SYMATTR InstName E5
SYMATTR Value 1.2
SYMBOL res 720 1728 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 150
SYMBOL res 720 1408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 150
SYMBOL e 432 1440 R0
SYMATTR InstName E6
SYMATTR Value 1.2
SYMBOL schottky 592 1328 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D11
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 592 1648 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D12
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 768 1328 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 20
SYMBOL res 768 1648 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 20
SYMBOL res 1328 640 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName RB
SYMATTR Value {R_Phase}
SYMBOL ind 1456 640 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName LB
SYMATTR Value {L_Phase}
SYMBOL res 1328 784 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName RC
SYMATTR Value {R_Phase}
SYMBOL ind 1456 784 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName LC
SYMATTR Value {L_Phase}
SYMBOL Subtractor -1152 -144 R0
SYMATTR InstName X1
SYMBOL sw -960 -320 R0
WINDOW 3 13 103 Left 2
SYMATTR Value VCS
SYMATTR InstName S1
SYMBOL Digital\\inv -496 -112 R0
SYMATTR InstName A7
SYMATTR SpiceLine Vhigh=5
SYMBOL Digital\\inv -496 784 R0
SYMATTR InstName A8
SYMATTR SpiceLine Vhigh=5
SYMBOL Digital\\inv -496 1712 R0
SYMATTR InstName A9
SYMATTR SpiceLine Vhigh=5
SYMBOL sw -960 -16 R0
WINDOW 3 13 103 Left 2
SYMATTR Value VCS
SYMATTR InstName S4
SYMBOL bv -2496 1920 R0
WINDOW 3 -149 171 Left 2
SYMATTR Value V=if(V(Va)>V(Vb),V(Va),V(Vb))
SYMATTR InstName B9
SYMBOL bv -2736 864 R0
WINDOW 3 59 55 Left 2
SYMATTR Value V=if(V(Vmax_ab)>V(Vc),V(Vmax_ab),V(Vc))
SYMATTR InstName B10
SYMBOL bv -2496 1440 R0
WINDOW 3 56 52 Left 2
SYMATTR Value V=if(V(Va)<V(Vb),V(Va),V(Vb))
SYMATTR InstName B11
SYMBOL bv -2592 672 R0
WINDOW 3 56 52 Left 2
SYMATTR Value V=if(V(Vmim_ab)<V(Vc),V(Vmim_ab),V(Vc))
SYMATTR InstName B12
SYMBOL Adder -2592 464 R0
SYMATTR InstName X4
SYMBOL Gain -2368 432 R0
WINDOW 3 -12 35 Left 2
SYMATTR Value 0.5
SYMATTR InstName E7
SYMBOL Subtractor -1728 -144 R0
SYMATTR InstName X5
SYMBOL Subtractor -1728 752 R0
SYMATTR InstName X6
SYMBOL Subtractor -1728 1680 R0
SYMATTR InstName X7
SYMBOL Subtractor -1152 752 R0
SYMATTR InstName X2
SYMBOL sw -960 576 R0
WINDOW 3 13 103 Left 2
SYMATTR Value VCS
SYMATTR InstName S2
SYMBOL sw -960 880 R0
WINDOW 3 13 103 Left 2
SYMATTR Value VCS
SYMATTR InstName S3
SYMBOL Subtractor -1152 1680 R0
SYMATTR InstName X3
SYMBOL sw -960 1504 R0
WINDOW 3 13 103 Left 2
SYMATTR Value VCS
SYMATTR InstName S5
SYMBOL sw -960 1808 R0
WINDOW 3 13 103 Left 2
SYMATTR Value VCS
SYMATTR InstName S6
SYMBOL bv -1920 -512 R0
SYMATTR InstName B2
SYMATTR Value V=V(Va)-0.5
SYMBOL voltage -2272 -496 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 0.5
SYMBOL voltage -2272 -336 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V11
SYMATTR Value 0.5
SYMBOL res 864 976 R0
SYMATTR InstName R24
SYMATTR Value 0.001
SYMBOL res 864 48 R0
SYMATTR InstName R25
SYMATTR Value 0.001
SYMBOL f 3440 384 R270
WINDOW 0 32 40 VTop 2
WINDOW 3 -32 40 VBottom 2
SYMATTR InstName TorqueA
SYMATTR Value I=(Ke*I(RA)*sin(V(theta_elec_dephased)))/1.5
SYMATTR Prefix B
SYMBOL f 3440 544 R270
WINDOW 0 32 40 VTop 2
WINDOW 3 -32 40 VBottom 2
SYMATTR InstName TorqueB
SYMATTR Value I=(Ke*I(RB)*sin(V(theta_elec_dephased)+(2*Pi/3)))/1.5
SYMATTR Prefix B
SYMBOL f 3440 704 R270
WINDOW 0 32 40 VTop 2
WINDOW 3 -32 40 VBottom 2
SYMATTR InstName TorqueC
SYMATTR Value I=(Ke*I(RC)*sin(V(theta_elec_dephased)-(2*Pi/3)))/1.5
SYMATTR Prefix B
SYMBOL bv 3536 1680 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName BEMFA
SYMATTR Value V=0*(Ke/Pole_pairs)*V(wd)*sin(V(theta_elec))
SYMBOL bv 3536 1824 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName BEMFA1
SYMATTR Value V=0*(Ke/Pole_pairs)*V(wd)*sin(V(theta_elec)+(2*Pi/3))
SYMBOL bv 3536 1968 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName BEMFA2
SYMATTR Value V=0*(Ke/Pole_pairs)*V(wd)*sin(V(theta_elec)-(2*Pi/3))
SYMBOL bv 1920 480 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName B6
SYMATTR Value V=V(EMFA)
SYMBOL bv 1920 624 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName B7
SYMATTR Value V=V(EMFB)
SYMBOL bv 1920 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName B8
SYMATTR Value V=V(EMFC)
SYMBOL bv 3552 944 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B13
SYMATTR Value V=0.5+V(amplitude)*sin(V(theta_elec)+BEMF_phase)
SYMBOL bv 3760 -384 R0
SYMATTR InstName B14
SYMATTR Value V=0.55*V(Duty_cycle_ex)
SYMBOL bv 3552 1104 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B15
SYMATTR Value V=0.5+V(amplitude)*sin(V(theta_elec)+(2*Pi/3)+BEMF_phase)
SYMBOL bv 3552 1264 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B16
SYMATTR Value V=0.5+V(amplitude)*sin(V(theta_elec)-(2*Pi/3)+BEMF_phase)
SYMBOL bv 1360 -16 R0
SYMATTR InstName B17
SYMATTR Value V=V(A)
SYMBOL cap 1648 16 R0
SYMATTR InstName C10
SYMATTR Value 120µ
SYMBOL res 1536 0 R0
SYMATTR InstName R28
SYMATTR Value 1G
SYMBOL res 1536 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 1
SYMBOL bv 2576 -224 R0
SYMATTR InstName B18
SYMATTR Value V=(( (I(ra)*sin(V(theta_elec_dephased)))+ (I(rb)*sin(V(theta_elec_dephased)+(2*Pi/3)))+ (I(rc)*sin(V(theta_elec_dephased)-(2*Pi/3)))))/1.5
SYMBOL bv 2464 -448 R0
SYMATTR InstName B19
SYMATTR Value V=I_Ref
SYMBOL TI-BLDC-example\\Support\ Pack\ Rev\ 1_1\\Subtractor 2736 -464 R0
SYMATTR InstName X10
SYMBOL TI-BLDC-example\\Support\ Pack\ Rev\ 1_1\\Clamp 3296 -464 R0
SYMATTR InstName X11
SYMBOL TI-BLDC-example\\Support\ Pack\ Rev\ 1_1\\Gain 3056 -496 R0
SYMATTR InstName E11
SYMATTR Value {Kp_I}
SYMBOL voltage 3296 -528 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 1
SYMBOL res 2720 -288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 1
SYMBOL Integrator 2528 1344 R0
SYMATTR InstName X12
SYMBOL Subtractor 1696 1168 R0
SYMATTR InstName X13
SYMBOL Integrator 2064 1168 R0
SYMATTR InstName X14
SYMBOL e 1888 1136 R0
SYMATTR InstName E12
SYMATTR Value {1/Jeq}
SYMBOL voltage 1696 1600 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value 0
SYMBOL Gain 2256 1760 R0
WINDOW 3 -25 31 Left 2
SYMATTR Value {30/Pi}
SYMATTR InstName E13
SYMBOL Gain 2256 1312 R0
WINDOW 3 -25 31 Left 2
SYMATTR Value {Pole_pairs}
SYMATTR InstName E14
SYMBOL bv 1392 1216 R0
SYMATTR InstName B20
SYMATTR Value V=I(RTORQUE_TOTAL)
SYMBOL bv 1360 -288 R0
SYMATTR InstName B21
SYMATTR Value V=V(a)*I(rA)+V(b)*I(rb)+V(c)*I(rc)
SYMBOL res 1584 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R31
SYMATTR Value 1k
SYMBOL cap 1648 -256 R0
SYMATTR InstName C12
SYMATTR Value 0.1µF
SYMBOL bv 3536 1504 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName BEMF_TOT
SYMATTR Value V=(Ke/Pole_pairs)*V(wd)
SYMBOL bv 1040 -832 R0
SYMATTR InstName B22
SYMATTR Value V=V(EMF_TOT)
SYMBOL res 3840 608 R0
SYMATTR InstName RTORQUE_TOTAL
SYMATTR Value 1
SYMBOL Opamps\\UniversalOpamp2 5088 896 R0
SYMATTR InstName U1
SYMBOL voltage 4976 656 R0
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V9
SYMATTR Value 1
SYMBOL voltage 5136 656 R0
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V10
SYMATTR Value -1
SYMBOL Opamps\\UniversalOpamp2 5088 1088 R0
SYMATTR InstName U2
SYMBOL Digital\\xor 5440 928 R0
SYMATTR InstName A10
SYMBOL bv 4816 912 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B4
SYMATTR Value V=I(RA)
SYMBOL bv 4816 1104 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B5
SYMATTR Value V=V(va)
SYMBOL voltage 5024 1200 R0
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V7
SYMATTR Value 0.5
SYMBOL bv 4864 1520 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B23
SYMATTR Value V=V(theta_elec)
SYMBOL Filt\\Delay 4960 1520 R0
SYMATTR SpiceLine2 t=0.52m
SYMATTR InstName U3
SYMBOL nmos 832 -480 R0
SYMATTR InstName M1
SYMATTR Value IPP030N10N3
SYMBOL nmos 832 -160 R0
SYMATTR InstName M2
SYMATTR Value IPP030N10N3
SYMBOL nmos 832 416 R0
SYMATTR InstName M3
SYMATTR Value IPP030N10N3
SYMBOL nmos 832 736 R0
SYMATTR InstName M4
SYMATTR Value IPP030N10N3
SYMBOL nmos 832 1344 R0
SYMATTR InstName M5
SYMATTR Value IPP030N10N3
SYMBOL nmos 832 1664 R0
SYMATTR InstName M6
SYMATTR Value IPP030N10N3
TEXT 4256 -560 Left 2 !.tran 0 100m 10us uic
TEXT 4256 112 Left 2 !.param p=50us
TEXT -512 -752 Left 2 ;Three Phase Centered PWMs\nMotoring with Unity Power Factor
TEXT 4256 144 Left 2 !.param phase=27
TEXT -1288 -744 Left 2 !.model VCS SW(Ron=0.00001 Roff=1T Vt=0)
TEXT 4256 -528 Left 2 !.options method = gear
TEXT -2696 -600 Left 2 ;S V M    W A V E F O R M    G E N E R A T O R
TEXT -1296 -584 Left 2 ;M O D U L A T O R
TEXT -648 -584 Left 2 ;D E A D    T I M E    G E N E R A T O R
TEXT 360 -584 Left 2 ;I N V E R T E R
TEXT 1360 368 Left 2 ;P M S    M O T O R
TEXT 4256 208 Left 2 !.param T_aperture_I=100E-9
TEXT 4256 176 Left 2 !.param Fs = 10E3
TEXT -2208 2248 Left 2 ;D A V E    W I L S O N\nK A P P A   E L E C T R O N I C S   L L C\ndave@kappaiq.com\nwww.kappaiq.com
TEXT 4256 -112 Left 2 !.param Ke=0.134
TEXT 4256 -432 Left 2 !.param Pi=3.1415
TEXT 4256 -80 Left 2 !.param J=0.61
TEXT 4256 -144 Left 2 !.param Load=0
TEXT 4256 48 Left 2 !.param Duty_cycle=0.5
TEXT 4256 -368 Left 2 !.param Pole_pairs=10
TEXT 4256 -256 Left 2 !.param I_Ref=80
TEXT 4256 -224 Left 2 !.param I_Max=42
TEXT 4256 -192 Left 2 !.param Kp_I=0.5
TEXT 1800 1048 Left 2 !.param Jeq=2E-3
TEXT 1312 1032 Left 2 ;LOAD
TEXT 4256 80 Left 2 !.param BEMF_phase=0
TEXT 4256 -336 Left 2 !.param L_Phase=140u
TEXT 4256 -304 Left 2 !.param R_Phase=110m
TEXT 4256 -464 Left 2 !.param sqrt2=1.414
TEXT 1328 -648 Left 2 ;MEASUREMENTS
TEXT 2376 -624 Left 2 ;CURRENT CONTROLLER (P)
TEXT 3232 280 Left 2 ;Torque, BEMF, V generators
TEXT 4248 -632 Left 2 ;PARAMETERS
TEXT -2800 2248 Left 2 ;Adapted from Simulations 08 + 40 + 41 by ->
TEXT -2888 2280 Left 2 ;Source: http://www.kappaiq.com/downloads/simulations
TEXT 1920 376 Left 2 ;Add BEMF if needed !!!
TEXT 4336 600 Left 2 ;This part is to detect the phase delay between voltage and current in the motor. This is needed to align torque and BEMF with electric angle of the rotor.
TEXT 4920 1624 Left 2 ;This is the delay between voltage and current simplified (power factor).
TEXT 3328 1432 Left 2 ;Here we are aligning BEMF to input voltage. This is probably wrong.
TEXT 3232 880 Left 2 ;Voltage applied to the rotor is also dependant on rotor electrical position.
TEXT 3744 464 Left 2 ;With the theta_elec_dephased we pretend to alignt the torque calculation with the current phase.
TEXT 2448 -760 Left 2 ;Simple proportional current controller
TEXT -696 -1392 Left 3 ;BLDC motor controller simulator.
TEXT -696 -1336 Left 2 ;TODO: Review BEMF generation and remove the need for the signal theta_elec_dephased
RECTANGLE Normal -1600 2176 -2800 -688
RECTANGLE Normal -800 2176 -1360 -688
RECTANGLE Normal 48 2176 -704 -688
RECTANGLE Normal 1184 2176 224 -688
RECTANGLE Normal 1872 896 1280 320
RECTANGLE Normal 2720 2176 1280 1008
